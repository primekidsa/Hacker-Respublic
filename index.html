<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Hacker Life OS</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- –°–¢–ò–õ–ò (CSS) --- */
        :root { --main-color: #0f0; --bg-color: #050505; --panel-bg: #111; }
        body {
            background-color: var(--bg-color);
            color: var(--main-color);
            font-family: 'Courier New', Courier, monospace;
            margin: 0; padding: 10px;
            display: flex;
            flex-direction: column;
            height: 95vh;
            user-select: none;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .stats-bar {
            background: var(--panel-bg);
            border: 1px solid var(--main-color);
            padding: 10px;
            margin-bottom: 10px;
            font-size: 14px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫—Ä–∞–Ω –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .screen {
            flex-grow: 1;
            border: 1px solid #004400;
            padding: 15px;
            overflow-y: auto;
            margin-bottom: 10px;
            background: rgba(0, 20, 0, 0.5);
            display: none; /* –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }
        .screen.active { display: block; } /* –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π */

        /* –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ú–µ–Ω—é) */
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        button {
            background: #002200;
            color: var(--main-color);
            border: 1px solid var(--main-color);
            padding: 15px;
            font-family: inherit;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            text-transform: uppercase;
            touch-action: manipulation;
        }
        button:active { background: var(--main-color); color: black; }
        button.back-btn { border-color: #f00; color: #f00; }

        /* –≠–ª–µ–º–µ–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ —ç–∫—Ä–∞–Ω–æ–≤ */
        .progress-bar {
            width: 100%; background: #333; height: 20px; margin-top: 10px;
            position: relative;
        }
        .progress-fill {
            height: 100%; background: var(--main-color); width: 0%;
            transition: width 0.1s;
        }
        .item-row {
            display: flex; justify-content: space-between;
            border-bottom: 1px solid #333; padding: 8px 0;
        }
        input {
            background: black; border: 1px solid var(--main-color);
            color: var(--main-color); padding: 5px; width: 80px;
            font-family: inherit;
        }
        h2 { border-bottom: 1px solid var(--main-color); margin-top: 0; }
        
        .log-entry { font-size: 12px; margin-bottom: 4px; opacity: 0.8; }
        #console-log { height: 100px; overflow-y: scroll; border-top: 1px dashed #0f0; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="stats-bar">
        <div id="stat-money">üíµ 0$</div>
        <div id="stat-bank">üè¶ 0$</div>
        <div id="stat-btc">‚Çø 0.0000</div>
        <div id="stat-energy">‚ö° 100%</div>
    </div>

    <div id="screen-main" class="screen active">
        <h2>TERMINAL_OS v2.0</h2>
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="username">Hacker</span>.</p>
        <p>–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥—É–ª—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞...</p>
        <div id="console-log"></div>
    </div>

    <div id="screen-work" class="screen">
        <h2>üíª –§—Ä–∏–ª–∞–Ω—Å</h2>
        <p id="project-name">–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞</p>
        <div class="progress-bar"><div id="work-progress" class="progress-fill"></div></div>
        <br>
        <button onclick="clickWork()" style="width:100%">üî® –ö–û–î–ò–¢–¨ (TAP)</button>
        <br><br>
        <p style="font-size: 12px; color: #888">–¢–∞–ø–∞–π –±—ã—Å—Ç—Ä–æ, —á—Ç–æ–±—ã –∑–∞–ø–æ–ª–Ω–∏—Ç—å —à–∫–∞–ª—É!</p>
    </div>

    <div id="screen-bank" class="screen">
        <h2>üè¶ Swiss Bank</h2>
        <p>–ù–∞ —Å—á–µ—Ç–µ: <b id="bank-val">0$</b></p>
        <div class="item-row">
            <span>–î–µ–ø–æ–∑–∏—Ç:</span>
            <input type="number" id="dep-amount" placeholder="100">
            <button onclick="bankOp('dep')">üì•</button>
        </div>
        <div class="item-row">
            <span>–°–Ω—è—Ç—å:</span>
            <input type="number" id="with-amount" placeholder="100">
            <button onclick="bankOp('with')">üì§</button>
        </div>
    </div>

    <div id="screen-crypto" class="screen">
        <h2>üìà Crypto Exchange</h2>
        <p>–ö—É—Ä—Å BTC: <b id="btc-rate">50000</b>$</p>
        <p>–í–∞—à–∏ BTC: <b id="btc-val">0.0000</b></p>
        <div class="item-row">
            <button onclick="tradeBtc('buy')">üìâ –ö—É–ø–∏—Ç—å (0.1)</button>
            <button onclick="tradeBtc('sell')">üìà –ü—Ä–æ–¥–∞—Ç—å (0.1)</button>
        </div>
        <div class="item-row">
            <span>–ú–∞–π–Ω–µ—Ä—ã: <b id="miner-count">0</b></span>
            <button onclick="buyMiner()">‚õè –ö—É–ø–∏—Ç—å (2000$)</button>
        </div>
    </div>

    <div id="screen-shop" class="screen">
        <h2>üõí DarkNet Market</h2>
        <div id="shop-list"></div>
    </div>

    <div id="screen-inventory" class="screen">
        <h2>üéí –†—é–∫–∑–∞–∫</h2>
        <div id="inventory-list">–ü—É—Å—Ç–æ...</div>
    </div>

    <div id="screen-pvp" class="screen">
        <h2>üíÄ PvP Hacking</h2>
        <p id="pvp-status">–ü–æ–∏—Å–∫ —Ü–µ–ª–∏...</p>
        <div id="hack-controls" style="display:none">
            <div class="progress-bar"><div id="hack-progress" class="progress-fill" style="background:red"></div></div>
            <br>
            <button onclick="doHack()" style="width:100%; border-color:red; color:red">üíÄ BRUTE FORCE</button>
        </div>
        <button id="btn-search-victim" onclick="startPvp()">üì° –ù–∞–π—Ç–∏ –∂–µ—Ä—Ç–≤—É</button>
    </div>

    <div class="controls" id="main-controls">
        <button onclick="nav('work')">üíª –†–∞–±–æ—Ç–∞</button>
        <button onclick="nav('bank')">üè¶ –ë–∞–Ω–∫</button>
        <button onclick="nav('crypto')">üìà –ö—Ä–∏–ø—Ç–æ</button>
        <button onclick="nav('shop')">üõí –ú–∞–≥–∞–∑–∏–Ω</button>
        <button onclick="nav('inventory')">üéí –†—é–∫–∑–∞–∫</button>
        <button onclick="nav('pvp')">üíÄ PvP</button>
    </div>
    
    <div class="controls" id="back-controls" style="display:none; margin-top: 10px;">
        <button class="back-btn" onclick="nav('main')">üîô MENU</button>
        <button onclick="saveAndClose()">üíæ SAVE & EXIT</button>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        // --- –î–ê–ù–ù–´–ï –ò–ì–†–û–ö–ê (–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é) ---
        let player = {
            money: 500,
            bank: 0,
            btc: 0.0,
            energy: 100,
            miners: 0,
            inventory: {},
            project: null
        };

        // –¢–æ–≤–∞—Ä—ã
        const ITEMS = {
            "coffee": {name: "–ö–æ—Ñ–µ", price: 40, energy: 30},
            "sandwich": {name: "–°—ç–Ω–¥–≤–∏—á", price: 90, energy: 60},
            "pizza": {name: "–ü–∏—Ü—Ü–∞", price: 200, energy: 100},
            "server": {name: "–°–µ—Ä–≤–µ—Ä", price: 1000, energy: 0}
        };

        let btcRate = 50000;

        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ---
        function init() {
            // –ï—Å–ª–∏ –±–æ—Ç –ø–µ—Ä–µ–¥–∞–ª –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ (–≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
            // –ü–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ.
            updateUI();
            renderShop();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∏–∫ —Ç–∞–π–º–µ—Ä–∞ (—ç–Ω–µ—Ä–≥–∏—è, –∫—É—Ä—Å, –º–∞–π–Ω–∏–Ω–≥)
            setInterval(tick, 2000);
            log("System started. Welcome.");
        }

        // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
        function nav(screenId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π
            document.getElementById('screen-' + screenId).classList.add('active');

            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∞–º–∏ –º–µ–Ω—é
            if (screenId === 'main') {
                document.getElementById('main-controls').style.display = 'grid';
                document.getElementById('back-controls').style.display = 'none';
            } else {
                document.getElementById('main-controls').style.display = 'none';
                document.getElementById('back-controls').style.display = 'grid';
            }
            
            updateUI();
        }

        // --- –û–ë–ù–û–í–õ–ï–ù–ò–ï UI ---
        function updateUI() {
            document.getElementById('stat-money').innerText = `üíµ ${Math.floor(player.money)}$`;
            document.getElementById('stat-bank').innerText = `üè¶ ${Math.floor(player.bank)}$`;
            document.getElementById('stat-btc').innerText = `‚Çø ${player.btc.toFixed(4)}`;
            document.getElementById('stat-energy').innerText = `‚ö° ${Math.floor(player.energy)}%`;
            
            // –ë–∞–Ω–∫
            document.getElementById('bank-val').innerText = `${Math.floor(player.bank)}$`;
            // –ö—Ä–∏–ø—Ç–∞
            document.getElementById('btc-val').innerText = player.btc.toFixed(4);
            document.getElementById('btc-rate').innerText = btcRate;
            document.getElementById('miner-count').innerText = player.miners;
            // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
            renderInventory();
        }

        function log(msg) {
            let con = document.getElementById('console-log');
            let time = new Date().toLocaleTimeString().split(' ')[0];
            con.innerHTML = `<div class="log-entry">[${time}] ${msg}</div>` + con.innerHTML;
        }

        // --- –õ–û–ì–ò–ö–ê: –†–ê–ë–û–¢–ê ---
        let workProg = 0;
        function clickWork() {
            if (player.energy < 1) { log("Error: Low Energy"); return; }
            
            player.energy -= 1;
            workProg += 5; // –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ –∫–ª–∏–∫
            
            // –í–∏–∑—É–∞–ª
            document.getElementById('work-progress').style.width = workProg + "%";
            
            if (workProg >= 100) {
                let reward = Math.floor(Math.random() * 50) + 50;
                player.money += reward;
                workProg = 0;
                document.getElementById('work-progress').style.width = "0%";
                log(`Job done. Earned: ${reward}$`);
                tg.HapticFeedback.notificationOccurred('success');
            } else {
                tg.HapticFeedback.impactOccurred('light');
            }
            updateUI();
        }

        // --- –õ–û–ì–ò–ö–ê: –ë–ê–ù–ö ---
        function bankOp(type) {
            let inp = type === 'dep' ? document.getElementById('dep-amount') : document.getElementById('with-amount');
            let val = parseInt(inp.value);
            if (!val || val <= 0) return;

            if (type === 'dep') {
                if (player.money >= val) {
                    player.money -= val; player.bank += val;
                    log(`Deposited ${val}$`);
                } else log("No cash");
            } else {
                if (player.bank >= val) {
                    player.bank -= val; player.money += val;
                    log(`Withdrew ${val}$`);
                } else log("No funds in bank");
            }
            inp.value = "";
            updateUI();
        }

        // --- –õ–û–ì–ò–ö–ê: –ö–†–ò–ü–¢–ê ---
        function tradeBtc(type) {
            let cost = btcRate * 0.1;
            if (type === 'buy') {
                if (player.money >= cost) {
                    player.money -= cost; player.btc += 0.1;
                    log("Bought 0.1 BTC");
                }
            } else {
                if (player.btc >= 0.1) {
                    player.btc -= 0.1; player.money += cost;
                    log("Sold 0.1 BTC");
                }
            }
            updateUI();
        }

        function buyMiner() {
            if (player.money >= 2000) {
                player.money -= 2000; player.miners++;
                log("Miner installed");
                updateUI();
            }
        }

        // --- –õ–û–ì–ò–ö–ê: –ú–ê–ì–ê–ó–ò–ù –ò –ò–ù–í–ï–ù–¢–ê–†–¨ ---
        function renderShop() {
            let html = "";
            for (let k in ITEMS) {
                let item = ITEMS[k];
                html += `<div class="item-row">
                    <span>${item.name} (+${item.energy}‚ö°)</span>
                    <button onclick="buyItem('${k}')" style="padding:5px; font-size:12px">${item.price}$</button>
                </div>`;
            }
            document.getElementById('shop-list').innerHTML = html;
        }

        function buyItem(key) {
            let item = ITEMS[key];
            if (player.money >= item.price) {
                player.money -= item.price;
                player.inventory[key] = (player.inventory[key] || 0) + 1;
                log(`Bought ${item.name}`);
                updateUI();
            } else log("Need money");
        }

        function renderInventory() {
            let html = "";
            let isEmpty = true;
            for (let k in player.inventory) {
                if (player.inventory[k] > 0) {
                    isEmpty = false;
                    html += `<div class="item-row">
                        <span>${ITEMS[k].name} (x${player.inventory[k]})</span>
                        <button onclick="useItem('${k}')" style="padding:5px; font-size:12px">EAT</button>
                    </div>`;
                }
            }
            document.getElementById('inventory-list').innerHTML = isEmpty ? "–ü—É—Å—Ç–æ..." : html;
        }

        function useItem(key) {
            if (player.inventory[key] > 0) {
                player.inventory[key]--;
                player.energy = Math.min(100, player.energy + ITEMS[key].energy);
                log(`Used ${ITEMS[key].name}`);
                updateUI();
            }
        }

        // --- –õ–û–ì–ò–ö–ê: PVP (–°–∏–º—É–ª—è—Ü–∏—è) ---
        let hackProg = 0;
        let pvpActive = false;
        
        function startPvp() {
            document.getElementById('btn-search-victim').style.display = 'none';
            document.getElementById('pvp-status').innerText = "–ü–æ–∏—Å–∫ IP...";
            
            setTimeout(() => {
                document.getElementById('pvp-status').innerText = "–¶–µ–ª—å: User_" + Math.floor(Math.random()*1000);
                document.getElementById('hack-controls').style.display = 'block';
                hackProg = 0;
                pvpActive = true;
                document.getElementById('hack-progress').style.width = "0%";
            }, 1500);
        }

        function doHack() {
            if (!pvpActive) return;
            if (player.energy < 2) return;
            player.energy -= 2;
            
            hackProg += 10;
            document.getElementById('hack-progress').style.width = hackProg + "%";
            tg.HapticFeedback.impactOccurred('medium');

            if (hackProg >= 100) {
                let stolen = Math.floor(Math.random() * 200) + 50;
                player.money += stolen;
                log(`HACK SUCCESS! Stolen: ${stolen}$`);
                tg.HapticFeedback.notificationOccurred('success');
                
                // –°–±—Ä–æ—Å
                pvpActive = false;
                document.getElementById('hack-controls').style.display = 'none';
                document.getElementById('btn-search-victim').style.display = 'block';
                document.getElementById('pvp-status').innerText = "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ.";
            }
            updateUI();
        }

        // --- –§–û–ù–û–í–´–ï –ü–†–û–¶–ï–°–°–´ ---
        function tick() {
            // –≠–Ω–µ—Ä–≥–∏—è
            if (player.energy < 100) player.energy += 1;
            
            // –ú–∞–π–Ω–∏–Ω–≥
            if (player.miners > 0) player.btc += (player.miners * 0.0001);
            
            // –ö—É—Ä—Å –ë–∏—Ç–∫–∞
            let change = Math.floor(Math.random() * 200) - 100;
            btcRate = Math.max(100, btcRate + change);
            
            updateUI();
        }

        // --- –°–û–•–†–ê–ù–ï–ù–ò–ï –ò –í–´–•–û–î ---
        function saveAndClose() {
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É (–∑–∞—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–µ–Ω—å–≥–∏)
            // –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≠—Ç–æ —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è. 
            // –í –∏–¥–µ–∞–ª–µ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–µ—Å—å state, –Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∏–º "—Ä–∞–∑–Ω–∏—Ü—É" –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—É—â–∏–µ –¥–µ–Ω—å–≥–∏
            // –ë–æ—Ç –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å —ç—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å.
            
            let data = JSON.stringify({
                amount: player.money, // –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å –ø—Ä–æ—à–ª—ã–º –∫–æ–¥–æ–º –∫–ª–∏–∫–µ—Ä–∞
                full_state: player    // –î–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è
            });
            
            tg.sendData(data);
            tg.close();
        }

        // –°—Ç–∞—Ä—Ç
        init();
    </script>
</body>
</html>
